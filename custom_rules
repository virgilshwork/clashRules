#####################################################
# åœ¨VARnä½ç½®æ’å…¥æ–‡æœ¬
#####################################################
VAR1='LocalAreaNetwork.list'
cat >VAR1<<- 'EOF'
ruleset=â“‚ï¸ åŠ å¯†è´§å¸,https://raw.githubusercontent.com/virgilshwork/clashrule/main/cryptoAll.list
ruleset=â“‚ï¸ æŒ–çŸ¿ä¸“åŒº,https://raw.githubusercontent.com/virgilshwork/clashrule/main/cryptoMinerPool.list
ruleset=â“‚ï¸ Direct,https://raw.githubusercontent.com/virgilshwork/clashrule/main/01_direct.list
ruleset=â“‚ï¸ Proxy,https://raw.githubusercontent.com/virgilshwork/clashrule/main/01_proxy.list
EOF

VAR2='è´Ÿè½½å‡è¡¡`load-balance`'
cat >VAR2<<- 'EOF'
custom_proxy_group=â“‚ï¸ åŠ å¯†è´§å¸`select`[]ğŸ”¯ æ•…éšœè½¬ç§»`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]â™»ï¸ è‡ªåŠ¨é€‰æ‹©`[]ğŸš€ æ‰‹åŠ¨åˆ‡æ¢`[]ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹`[]ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹`[]DIRECT
custom_proxy_group=â“‚ï¸ æŒ–çŸ¿ä¸“åŒº`select`[]ğŸ”¯ æ•…éšœè½¬ç§»`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]â™»ï¸ è‡ªåŠ¨é€‰æ‹©`[]ğŸš€ æ‰‹åŠ¨åˆ‡æ¢`[]DIRECT`[]ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
custom_proxy_group=â“‚ï¸ Direct`select`[]PASS`[]DIRECT`[]REJECT
custom_proxy_group=â“‚ï¸ Proxy`select`[]ğŸ”¯ æ•…éšœè½¬ç§»`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]â™»ï¸ è‡ªåŠ¨é€‰æ‹©`[]ğŸš€ æ‰‹åŠ¨åˆ‡æ¢`[]ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹`[]ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹`[]DIRECT
EOF

#####################################################
# æ›¿æ¢æ–‡æœ¬ï¼Œ2è¡Œä¸€ç»„ã€‚
#####################################################
cat >replaceText<<- 'EOF'
select`[]REJECT`[]DIRECT
select`[]PASS`[]DIRECT`[]REJECT
`[]ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹

æ¼ç½‘ä¹‹é±¼`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]â™»ï¸ è‡ªåŠ¨é€‰æ‹©`[]DIRECT
æ¼ç½‘ä¹‹é±¼`select`[]DIRECT`[]PASS`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]â™»ï¸ è‡ªåŠ¨é€‰æ‹©
æ¸¸æˆå¹³å°`select`[]DIRECT`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©
æ¸¸æˆå¹³å°`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]DIRECT
custom_proxy_group=â™»ï¸ è‡ªåŠ¨é€‰æ‹©`url-test`.*
custom_proxy_group=â™»ï¸ è‡ªåŠ¨é€‰æ‹©`url-test`(US|HK)``http://www.apple.com/library/test/success.html`300,,50
custom_proxy_group=ğŸ”¯ æ•…éšœè½¬ç§»`fallback`.*
custom_proxy_group=ğŸ”¯ æ•…éšœè½¬ç§»`fallback`(US|HK)``http://www.apple.com/library/test/success.html`300,,50
custom_proxy_group=ğŸ”® è´Ÿè½½å‡è¡¡`load-balance`.*
custom_proxy_group=ğŸ”® è´Ÿè½½å‡è¡¡`load-balance`(US|HK)``http://www.apple.com/library/test/success.html`300,,50
custom_proxy_group=ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
;custom_proxy_group=ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
;ruleset=ğŸ¯ å…¨çƒç›´è¿,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaIp.list
ruleset=ğŸ¯ å…¨çƒç›´è¿,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaIp.list
http://www.gstatic.com/generate_204`300,,50
http://www.apple.com/library/test/success.html`300,,50
EOF

#####################################################
# æŠ“å–ACL4SSR_Online_Full_MultiMode
#####################################################
curl https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full_MultiMode.ini > virgil.ini

#####################################################
# æ‰§è¡Œæ’å…¥æŒ‡ä»¤
#####################################################
sed -i "/$VAR1/r VAR1" virgil.ini
sed -i "/$VAR2/r VAR2" virgil.ini

#####################################################
# æ‰§è¡Œæ›¿æ¢æŒ‡ä»¤
#####################################################
checkPoint=0
fromText=""
cat replaceText|while read line
do
  line=${line//\//\\/}
  if [ $checkPoint -eq "0" ]; then
        fromText=$line
        checkPoint=1
  else
        sed -i "s/${fromText//\[/\\[}/${line//\[/\\[}/g" virgil.ini
        checkPoint=0
  fi
done
